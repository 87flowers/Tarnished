#pragma once
#include <bit>
#include <vector>
#include <sstream>
#include <cassert>
#include <cstring>
#include <cmath>
#include <list>

// 9->8->1
// TO TEST:
// - Different activation (Swedishchef)
// - Different arch
// 

constexpr int lmrInputs = 9;
constexpr int lmrHL = 16;

constexpr std::array<std::array<double, 9>, lmrHL> lmrL1 = {{
	{{0.297076016664505, -0.044372715055942535, 0.04702102020382881, 0.17810022830963135, -0.022190000861883163, 0.1375807821750641, -0.1807054579257965, -0.27180543541908264, -0.3039201498031616}}, 
	{{0.16390208899974823, -0.2785191237926483, -0.0240725576877594, -0.19049733877182007, -0.035638414323329926, 0.10300114005804062, -0.005512212868779898, 0.16334521770477295, 0.08919188380241394}}, 
	{{0.04527398198843002, 0.3050393760204315, 0.25191667675971985, -0.29216575622558594, 0.09081389755010605, -0.17890764772891998, 0.1881909966468811, 0.19407916069030762, 0.09553410112857819}}, 
	{{-0.17357304692268372, 0.19900155067443848, 0.15743187069892883, -0.1315329670906067, 0.0005973674124106765, 0.25367605686187744, -0.03661465644836426, -0.1981772929430008, -0.04091031104326248}}, 
	{{0.13024412095546722, 0.048403870314359665, -0.2725973129272461, -0.04167456924915314, -0.2276560217142105, 0.11839662492275238, 0.08065270632505417, 0.130205437541008, 0.19405218958854675}}, 
	{{0.17472289502620697, 0.1006273552775383, 0.21046499907970428, -0.1507072150707245, -0.0011420710943639278, -0.042450785636901855, -0.01161347609013319, -0.19367051124572754, 0.23965634405612946}}, 
	{{0.19611474871635437, -0.047048695385456085, -0.29434922337532043, -0.1408957690000534, -0.12505878508090973, -0.2545241713523865, -0.24312728643417358, 0.11392701417207718, -0.29579704999923706}}, 
	{{-0.10424026846885681, 0.04773053899407387, -0.19545884430408478, -0.2689066529273987, 0.3237498700618744, 0.0699092224240303, -0.2876144051551819, -0.08200907707214355, 0.032867681235075}}, 
	{{-0.21068178117275238, 0.005909943953156471, 0.2931452989578247, -0.009931090287864208, -0.23067410290241241, -0.1193152666091919, 0.08795391768217087, -0.23353905975818634, 0.32330122590065}}, 
	{{0.18553705513477325, 0.04314267262816429, 0.2136511206626892, 0.1473226398229599, 0.1683652102947235, 0.019592493772506714, 0.061013348400592804, 0.09429054707288742, -0.007060526870191097}}, 
	{{-0.1952449381351471, 0.3029378056526184, 0.0015888637863099575, -0.3001653254032135, 0.023911070078611374, 0.19587472081184387, 0.1486198455095291, 0.06413683295249939, 0.07930226624011993}}, 
	{{0.10306509584188461, 0.25157198309898376, 0.040720850229263306, 0.14224877953529358, -0.042023684829473495, 0.050894610583782196, 0.30015769600868225, -0.2804921865463257, -0.22461844980716705}}, 
	{{-0.01055536326020956, 0.3114561438560486, 0.06967505067586899, 0.1707470566034317, 0.08909619599580765, -0.18448512256145477, -0.03428389132022858, -0.23603996634483337, -0.2909243404865265}}, 
	{{0.0014856455381959677, 0.020865093916654587, -0.07893004268407822, -0.1892329454421997, 0.31077706813812256, 0.001600398332811892, -0.20802250504493713, -0.2738208770751953, 0.19391879439353943}}, 
	{{-0.04707659035921097, 0.3213777542114258, -0.13890430331230164, -0.1558162271976471, -0.0008185255574062467, 0.10770025849342346, -0.036046627908945084, -0.10424600541591644, 0.2966335415840149}}, 
	{{0.19249598681926727, -0.06705541163682938, 0.11611008644104004, -0.1580987125635147, -0.17186510562896729, 0.28687459230422974, -0.09814606606960297, -0.010958371683955193, 0.20192672312259674}}
}};

constexpr std::array<double, lmrHL> lmrL1Bias = {-0.09944891929626465, 0.14590930938720703, 0.23249885439872742, -0.2685493230819702, -0.04839440807700157, 0.06490832567214966, 0.08378004282712936, 0.09956227988004684, 0.13211986422538757, 0.3264480531215668, -0.24759548902511597, 0.05925627052783966, 0.2727647125720978, 0.03374205902218819, 0.22781361639499664, 0.23608331382274628};

constexpr std::array<double, lmrHL> lmrOutput = {0.026932133361697197, 0.16928721964359283, -0.20406343042850494, 0.07202857732772827, -0.19772619009017944, 0.22666555643081665, -0.1683947741985321, 0.08661563694477081, 0.24712586402893066, 0.1745477318763733, 0.2441510260105133, -0.04032348841428757, -0.21215565502643585, 0.0968981385231018, 0.22067981958389282, 0.04106053337454796};

constexpr double lmrOutputBias = -0.1258230358362198;